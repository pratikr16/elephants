<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 5 Getting spatial data | Fine-Scale Tracking of Ambient Temperature and Movement Reveals Shuttling Behavior of Elephants to Water</title>
  <meta name="description" content="Source code for Thaker, Gupte et al. (2019)" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 5 Getting spatial data | Fine-Scale Tracking of Ambient Temperature and Movement Reveals Shuttling Behavior of Elephants to Water" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Source code for Thaker, Gupte et al. (2019)" />
  <meta name="github-repo" content="pratikunterwegs/elephantTempKruger" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 5 Getting spatial data | Fine-Scale Tracking of Ambient Temperature and Movement Reveals Shuttling Behavior of Elephants to Water" />
  
  <meta name="twitter:description" content="Source code for Thaker, Gupte et al. (2019)" />
  

<meta name="author" content="Maria Thaker, Pratik R. Gupte, Herbert HT Prins, Rob Slotow, and Abi T. Vanak" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="preliminary-data-preparation.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contact"><i class="fa fa-check"></i><b>1.1</b> Contact</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#data-access"><i class="fa fa-check"></i><b>1.2</b> Data access</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-processing"><i class="fa fa-check"></i><b>1.3</b> Data processing</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html"><i class="fa fa-check"></i><b>2</b> Collar temperature and ambient temperature</a><ul>
<li class="chapter" data-level="2.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#load-libraries"><i class="fa fa-check"></i><b>2.1</b> Load libraries</a></li>
<li class="chapter" data-level="2.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#load-tracking-and-temperature-data"><i class="fa fa-check"></i><b>2.2</b> Load tracking and temperature data</a></li>
<li class="chapter" data-level="2.3" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#select-ele-data-near-tower"><i class="fa fa-check"></i><b>2.3</b> Select ele data near tower</a><ul>
<li class="chapter" data-level="2.3.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#convert-to-sf-and-filter"><i class="fa fa-check"></i><b>2.3.1</b> Convert to <code>sf</code> and filter</a></li>
<li class="chapter" data-level="2.3.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#clean-filtered-data"><i class="fa fa-check"></i><b>2.3.2</b> Clean filtered data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#combine-collar-and-ambient-temp"><i class="fa fa-check"></i><b>2.4</b> Combine collar and ambient temp</a><ul>
<li class="chapter" data-level="2.4.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-data-for-bland-altman"><i class="fa fa-check"></i><b>2.4.1</b> Prepare data for Bland-Altman</a></li>
<li class="chapter" data-level="2.4.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-fig.-3-a-daily-temperature-trend"><i class="fa fa-check"></i><b>2.4.2</b> Prepare Fig. 3 (A): Daily temperature trend</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#exploring-collar-and-ambient-temp"><i class="fa fa-check"></i><b>2.5</b> Exploring collar and ambient temp</a><ul>
<li class="chapter" data-level="2.5.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-data-for-models"><i class="fa fa-check"></i><b>2.5.1</b> Prepare data for models</a></li>
<li class="chapter" data-level="2.5.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#run-models-per-hour"><i class="fa fa-check"></i><b>2.5.2</b> Run models per hour</a></li>
<li class="chapter" data-level="2.5.3" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-data-for-plotting"><i class="fa fa-check"></i><b>2.5.3</b> Prepare data for plotting</a></li>
<li class="chapter" data-level="2.5.4" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-bland-altman-plots"><i class="fa fa-check"></i><b>2.5.4</b> Prepare Bland-Altman plots</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#model-collar-and-ambient-temp"><i class="fa fa-check"></i><b>2.6</b> Model collar and ambient temp</a><ul>
<li class="chapter" data-level="2.6.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#lmm-collar-and-ambient-temp"><i class="fa fa-check"></i><b>2.6.1</b> LMM collar and ambient temp</a></li>
<li class="chapter" data-level="2.6.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#get-variance-components"><i class="fa fa-check"></i><b>2.6.2</b> Get variance components</a></li>
<li class="chapter" data-level="2.6.3" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-figure-3-b-collar-ambient-temperature"><i class="fa fa-check"></i><b>2.6.3</b> Prepare Figure 3 (B): Collar ~ ambient temperature</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#global-bland-altman-test"><i class="fa fa-check"></i><b>2.7</b> Global Bland-Altman test</a><ul>
<li class="chapter" data-level="2.7.1" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-data-for-global-bland-altman"><i class="fa fa-check"></i><b>2.7.1</b> Prepare data for global Bland-Altman</a></li>
<li class="chapter" data-level="2.7.2" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#gamm-for-bland-altman-trend"><i class="fa fa-check"></i><b>2.7.2</b> GAMM for Bland-Altman trend</a></li>
<li class="chapter" data-level="2.7.3" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#prepare-fig.-3-c-bland-altman-plot"><i class="fa fa-check"></i><b>2.7.3</b> Prepare Fig. 3 (C): Bland-Altman plot</a></li>
<li class="chapter" data-level="2.7.4" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#write-hourly-model-summaries-to-file"><i class="fa fa-check"></i><b>2.7.4</b> Write hourly model summaries to file</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="collar-temperature-and-ambient-temperature.html"><a href="collar-temperature-and-ambient-temperature.html#figure-3-collar-and-ambient-temperature"><i class="fa fa-check"></i><b>2.8</b> Figure 3: Collar and ambient temperature</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html"><i class="fa fa-check"></i><b>3</b> Speed and collar temperature</a><ul>
<li class="chapter" data-level="3.1" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#load-libraries-1"><i class="fa fa-check"></i><b>3.1</b> Load libraries</a></li>
<li class="chapter" data-level="3.2" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#load-data-from-sources"><i class="fa fa-check"></i><b>3.2</b> Load data from sources</a></li>
<li class="chapter" data-level="3.3" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#speed-and-temperature"><i class="fa fa-check"></i><b>3.3</b> Speed and temperature</a><ul>
<li class="chapter" data-level="3.3.1" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#run-gamm-speed-temperature"><i class="fa fa-check"></i><b>3.3.1</b> Run GAMM speed ~ temperature</a></li>
<li class="chapter" data-level="3.3.2" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#prepare-speed-temp-plot-data"><i class="fa fa-check"></i><b>3.3.2</b> Prepare speed ~ temp plot data</a></li>
<li class="chapter" data-level="3.3.3" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#prepare-figure-4-a-speed-and-temperature"><i class="fa fa-check"></i><b>3.3.3</b> Prepare Figure 4 (A): Speed and temperature</a></li>
<li class="chapter" data-level="3.3.4" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#prepare-data-for-speed-woodland-plot"><i class="fa fa-check"></i><b>3.3.4</b> Prepare data for speed ~ woodland plot</a></li>
<li class="chapter" data-level="3.3.5" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#prepare-figure-4-b-speed-and-woody-cover"><i class="fa fa-check"></i><b>3.3.5</b> Prepare Figure 4 (B): Speed and woody cover</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="speed-and-collar-temperature.html"><a href="speed-and-collar-temperature.html#figure-4-speed-and-temperature-and-woody-cover"><i class="fa fa-check"></i><b>3.4</b> Figure 4: Speed and temperature and woody cover</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html"><i class="fa fa-check"></i><b>4</b> Preliminary data preparation</a><ul>
<li class="chapter" data-level="4.1" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#load-libraries-2"><i class="fa fa-check"></i><b>4.1</b> Load libraries</a></li>
<li class="chapter" data-level="4.2" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#load-data"><i class="fa fa-check"></i><b>4.2</b> Load data</a></li>
<li class="chapter" data-level="4.3" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#preliminary-checks"><i class="fa fa-check"></i><b>4.3</b> Preliminary checks</a></li>
<li class="chapter" data-level="4.4" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#fix-problematic-coordinates"><i class="fa fa-check"></i><b>4.4</b> Fix problematic coordinates</a><ul>
<li class="chapter" data-level="4.4.1" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#save-fixed-coordinates"><i class="fa fa-check"></i><b>4.4.1</b> Save fixed coordinates</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#data-distribution-in-time"><i class="fa fa-check"></i><b>4.5</b> Data distribution in time</a><ul>
<li class="chapter" data-level="4.5.1" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#seasonal-summary"><i class="fa fa-check"></i><b>4.5.1</b> Seasonal summary</a></li>
<li class="chapter" data-level="4.5.2" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#monthly-summary"><i class="fa fa-check"></i><b>4.5.2</b> Monthly summary</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#elephants-near-the-weather-station"><i class="fa fa-check"></i><b>4.6</b> Elephants near the weather station</a><ul>
<li class="chapter" data-level="4.6.1" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#load-skukuza"><i class="fa fa-check"></i><b>4.6.1</b> Load Skukuza</a></li>
<li class="chapter" data-level="4.6.2" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#select-elephants-within-10-km"><i class="fa fa-check"></i><b>4.6.2</b> Select elephants within 10 km</a></li>
<li class="chapter" data-level="4.6.3" data-path="preliminary-data-preparation.html"><a href="preliminary-data-preparation.html#get-distribution-over-time"><i class="fa fa-check"></i><b>4.6.3</b> Get distribution over time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="getting-spatial-data.html"><a href="getting-spatial-data.html"><i class="fa fa-check"></i><b>5</b> Getting spatial data</a><ul>
<li class="chapter" data-level="5.1" data-path="getting-spatial-data.html"><a href="getting-spatial-data.html#load-libraries-3"><i class="fa fa-check"></i><b>5.1</b> Load libraries</a></li>
<li class="chapter" data-level="5.2" data-path="getting-spatial-data.html"><a href="getting-spatial-data.html#getting-temperature-data"><i class="fa fa-check"></i><b>5.2</b> Getting temperature data</a></li>
<li class="chapter" data-level="5.3" data-path="getting-spatial-data.html"><a href="getting-spatial-data.html#getting-elevation-data"><i class="fa fa-check"></i><b>5.3</b> Getting elevation data</a></li>
<li class="chapter" data-level="5.4" data-path="getting-spatial-data.html"><a href="getting-spatial-data.html#reproject-data-to-utm-36s"><i class="fa fa-check"></i><b>5.4</b> Reproject data to UTM 36S</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Fine-Scale Tracking of Ambient Temperature and Movement Reveals Shuttling Behavior of Elephants to Water</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="getting-spatial-data" class="section level1">
<h1><span class="header-section-number">Section 5</span> Getting spatial data</h1>
<div id="load-libraries-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Load libraries</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># load libraries</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>This section looks at using Google Earth Engine <span class="citation">(Gorelick et al. <a href="#ref-gorelick2017">2017</a>)</span> to retrieve remote sensing data and process it for use.
<strong>This code is in Javascript</strong>. The cropped raster can be saved to your Google Drive.
Retrieval of the raster from Drive is not covered. The data are much too large to be rendered here, and their inspection is also not covered.</p>
</div>
<div id="getting-temperature-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Getting temperature data</h2>
<p>Code to get 30m thermal data from LANDSAT-5 <span class="citation">(Schmidt et al. <a href="#ref-schmidt2013">2013</a>)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb53-1" title="1"><span class="co">// get extent and landsat 5 data</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">var</span> geometry <span class="op">=</span> <span class="co">/* color: #ff3d3d */</span><span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">Polygon</span>(</a>
<a class="sourceLine" id="cb53-3" title="3">        [[[<span class="fl">77.26686452041235</span><span class="op">,</span> <span class="fl">13.344492655458648</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb53-4" title="4">          [<span class="fl">77.26803063514615</span><span class="op">,</span> <span class="fl">12.69020162411501</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb53-5" title="5">          [<span class="fl">78.31220864869454</span><span class="op">,</span> <span class="fl">12.698000169170149</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb53-6" title="6">          [<span class="fl">78.31998125667042</span><span class="op">,</span> <span class="fl">13.342950249131635</span>]]])<span class="op">,</span></a>
<a class="sourceLine" id="cb53-7" title="7">    table <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/pratik_unterwegs/ele_ext&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb53-8" title="8">    table2 <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/pratik_unterwegs/kruger_clip&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb53-9" title="9">    l5 <span class="op">=</span> <span class="va">ee</span>.<span class="at">ImageCollection</span>(<span class="st">&quot;LANDSAT/LT05/C01/T1_SR&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb53-10" title="10"></a>
<a class="sourceLine" id="cb53-11" title="11"><span class="co">//define func</span></a>
<a class="sourceLine" id="cb53-12" title="12"><span class="kw">var</span> crop <span class="op">=</span> <span class="kw">function</span>(x)<span class="op">{</span></a>
<a class="sourceLine" id="cb53-13" title="13">  <span class="kw">var</span> image <span class="op">=</span> <span class="va">x</span>.</a>
<a class="sourceLine" id="cb53-14" title="14">  <span class="at">clip</span>(table).</a>
<a class="sourceLine" id="cb53-15" title="15">  <span class="at">divide</span>(<span class="dv">10</span>).</a>
<a class="sourceLine" id="cb53-16" title="16">  <span class="at">subtract</span>(<span class="dv">273</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb53-17" title="17">  <span class="cf">return</span> image<span class="op">;</span></a>
<a class="sourceLine" id="cb53-18" title="18"><span class="op">}</span></a>
<a class="sourceLine" id="cb53-19" title="19"></a>
<a class="sourceLine" id="cb53-20" title="20"><span class="co">// filter landsat 5 data for time, cloud cover, and thermal band</span></a>
<a class="sourceLine" id="cb53-21" title="21"><span class="kw">var</span> filtered <span class="op">=</span> <span class="va">l5</span>.<span class="at">filterDate</span>(<span class="st">&#39;2007-08-01&#39;</span><span class="op">,</span> <span class="st">&#39;2009-08-30&#39;</span>).</a>
<a class="sourceLine" id="cb53-22" title="22">  <span class="at">filterMetadata</span>(<span class="st">&#39;CLOUD_COVER&#39;</span><span class="op">,</span> <span class="st">&#39;less_than&#39;</span><span class="op">,</span> <span class="dv">10</span>).</a>
<a class="sourceLine" id="cb53-23" title="23">  <span class="at">select</span>(<span class="st">&#39;B6&#39;</span>).</a>
<a class="sourceLine" id="cb53-24" title="24">  <span class="at">map</span>(crop).</a>
<a class="sourceLine" id="cb53-25" title="25"> <span class="at">mean</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb53-26" title="26"></a>
<a class="sourceLine" id="cb53-27" title="27"><span class="kw">var</span> rgb_viz <span class="op">=</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">20</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">35</span><span class="op">,</span> <span class="dt">bands</span><span class="op">:</span>[<span class="st">&#39;B6&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb53-28" title="28">  <span class="dt">palette</span><span class="op">:</span> [<span class="st">&quot;#0D0887FF&quot;</span><span class="op">,</span> <span class="st">&quot;#4C02A1FF&quot;</span><span class="op">,</span> <span class="st">&quot;#7E03A8FF&quot;</span><span class="op">,</span> <span class="st">&quot;#A92395FF&quot;</span><span class="op">,</span> <span class="st">&quot;#CC4678FF&quot;</span><span class="op">,</span> <span class="st">&quot;#E56B5DFF&quot;</span><span class="op">,</span><span class="st">&quot;#F89441FF&quot;</span><span class="op">,</span> <span class="st">&quot;#FDC328FF&quot;</span><span class="op">,</span> <span class="st">&quot;#F0F921FF&quot;</span>]</a>
<a class="sourceLine" id="cb53-29" title="29"><span class="op">};</span></a>
<a class="sourceLine" id="cb53-30" title="30"></a>
<a class="sourceLine" id="cb53-31" title="31"><span class="va">Map</span>.<span class="at">addLayer</span>(filtered<span class="op">,</span> rgb_viz<span class="op">,</span> <span class="st">&#39;kruger_temp&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb53-32" title="32"></a>
<a class="sourceLine" id="cb53-33" title="33"><span class="co">// export to google drive</span></a>
<a class="sourceLine" id="cb53-34" title="34"><span class="va">Export</span>.<span class="va">image</span>.<span class="at">toDrive</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb53-35" title="35">  <span class="dt">image</span><span class="op">:</span> filtered<span class="op">,</span></a>
<a class="sourceLine" id="cb53-36" title="36">  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;kruger_temperature&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb53-37" title="37">  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></a>
<a class="sourceLine" id="cb53-38" title="38">  <span class="dt">region</span><span class="op">:</span> <span class="va">table</span>.<span class="at">geometry</span>()<span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
</div>
<div id="getting-elevation-data" class="section level2">
<h2><span class="header-section-number">5.3</span> Getting elevation data</h2>
<p>Code to get 30m elevation data from SRTM <span class="citation">(Farr et al. <a href="#ref-farr2007">2007</a>)</span> using the Google Earth Engine Javascript API. This data was acquired and later not used.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb54-1" title="1"><span class="co">//load SRTM data and elephant extent</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">var</span> image <span class="op">=</span> <span class="va">ee</span>.<span class="at">Image</span>(<span class="st">&quot;USGS/SRTMGL1_003&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb54-3" title="3">    table <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/pratik_unterwegs/ele_ext&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb54-4" title="4">    ext <span class="op">=</span> <span class="va">ee</span>.<span class="at">FeatureCollection</span>(<span class="st">&quot;users/pratik_unterwegs/ele_ext&quot;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb54-5" title="5">    geometry <span class="op">=</span> <span class="va">ee</span>.<span class="va">Geometry</span>.<span class="at">MultiPoint</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb54-6" title="6">    </a>
<a class="sourceLine" id="cb54-7" title="7"><span class="co">//filter 30m DEM for the polygon</span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="kw">var</span> srtm_clip <span class="op">=</span> <span class="va">image</span>.<span class="at">clip</span>(<span class="va">ext</span>.<span class="at">geometry</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb54-9" title="9"></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="va">Map</span>.<span class="at">addLayer</span>(table)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-11" title="11"></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="co">//get slope</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="kw">var</span> srtm_slope <span class="op">=</span> <span class="va">ee</span>.<span class="va">Terrain</span>.<span class="at">slope</span>(srtm_clip)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-14" title="14"></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co">//check elevation map</span></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="va">Map</span>.<span class="at">addLayer</span>(srtm_clip<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max </span><span class="op">:</span><span class="dv">500</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">&quot;#00A600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#2DB600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#63C600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#A0D600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#E6E600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#E8C32EFF&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-17" title="17"><span class="st">&quot;#EBB25EFF&quot;</span><span class="op">,</span> <span class="st">&quot;#EDB48EFF&quot;</span><span class="op">,</span> <span class="st">&quot;#F0C9C0FF&quot;</span><span class="op">,</span> <span class="st">&quot;#F2F2F2FF&quot;</span></a>
<a class="sourceLine" id="cb54-18" title="18">]<span class="op">},</span> <span class="st">&#39;elevation&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-19" title="19"></a>
<a class="sourceLine" id="cb54-20" title="20"><span class="co">// check slope map</span></a>
<a class="sourceLine" id="cb54-21" title="21"><span class="va">Map</span>.<span class="at">addLayer</span>(srtm_slope<span class="op">,</span> <span class="op">{</span><span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max </span><span class="op">:</span><span class="dv">10</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span> [<span class="st">&quot;#00A600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#2DB600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#63C600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#A0D600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#E6E600FF&quot;</span><span class="op">,</span> <span class="st">&quot;#E8C32EFF&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-22" title="22"><span class="st">&quot;#EBB25EFF&quot;</span><span class="op">,</span> <span class="st">&quot;#EDB48EFF&quot;</span><span class="op">,</span> <span class="st">&quot;#F0C9C0FF&quot;</span><span class="op">,</span> <span class="st">&quot;#F2F2F2FF&quot;</span></a>
<a class="sourceLine" id="cb54-23" title="23">]<span class="op">},</span> <span class="st">&#39;slope&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-24" title="24"></a>
<a class="sourceLine" id="cb54-25" title="25"><span class="co">//export to file</span></a>
<a class="sourceLine" id="cb54-26" title="26"><span class="va">Export</span>.<span class="va">image</span>.<span class="at">toDrive</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb54-27" title="27">  <span class="dt">image</span><span class="op">:</span> srtm_clip<span class="op">,</span></a>
<a class="sourceLine" id="cb54-28" title="28">  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;kruger_elevation&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-29" title="29">  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-30" title="30">  <span class="dt">region</span><span class="op">:</span> <span class="va">table</span>.<span class="at">geometry</span>()</a>
<a class="sourceLine" id="cb54-31" title="31"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-32" title="32"></a>
<a class="sourceLine" id="cb54-33" title="33"><span class="va">Export</span>.<span class="va">image</span>.<span class="at">toDrive</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb54-34" title="34">  <span class="dt">image</span><span class="op">:</span> srtm_slope<span class="op">,</span></a>
<a class="sourceLine" id="cb54-35" title="35">  <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;kruger_slope&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-36" title="36">  <span class="dt">scale</span><span class="op">:</span> <span class="dv">30</span><span class="op">,</span></a>
<a class="sourceLine" id="cb54-37" title="37">  <span class="dt">region</span><span class="op">:</span> <span class="va">table</span>.<span class="at">geometry</span>()</a>
<a class="sourceLine" id="cb54-38" title="38"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
</div>
<div id="reproject-data-to-utm-36s" class="section level2">
<h2><span class="header-section-number">5.4</span> Reproject data to UTM 36S</h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="co"># use gdalwarp from gdalutils</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">library</span>(gdalUtils)</a>
<a class="sourceLine" id="cb55-3" title="3"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb55-4" title="4"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb55-5" title="5"></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="co"># list the files and warp them</span></a>
<a class="sourceLine" id="cb55-7" title="7">kruger_terrain =<span class="st"> </span><span class="kw">list.files</span>(<span class="st">&quot;data&quot;</span>, <span class="dt">pattern =</span> <span class="st">&quot;kruger_&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb55-8" title="8"></a>
<a class="sourceLine" id="cb55-9" title="9"><span class="kw">map</span>(kruger_terrain, <span class="cf">function</span>(df){</a>
<a class="sourceLine" id="cb55-10" title="10">  name =<span class="st"> </span><span class="kw">str_split</span>(df, <span class="st">&quot;.tif&quot;</span>, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)[,<span class="dv">1</span>] </a>
<a class="sourceLine" id="cb55-11" title="11"></a>
<a class="sourceLine" id="cb55-12" title="12">  <span class="kw">gdalwarp</span>(<span class="dt">srcfile =</span> df, </a>
<a class="sourceLine" id="cb55-13" title="13">           <span class="dt">dstfile =</span> <span class="kw">as.character</span>(<span class="kw">glue</span>(<span class="st">&#39;{name}_UTM.tif&#39;</span>)),</a>
<a class="sourceLine" id="cb55-14" title="14">           <span class="dt">t_srs =</span> <span class="st">&quot;+proj=utm +zone=36 +south +datum=WGS84 +units=m +no_defs&quot;</span>,</a>
<a class="sourceLine" id="cb55-15" title="15">           <span class="dt">tr =</span> <span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">30</span>))</a>
<a class="sourceLine" id="cb55-16" title="16">})</a></code></pre></div>

<div id="refs" class="references">
<div>
<p>Farr, Tom G., Paul A. Rosen, Edward Caro, Robert Crippen, Riley Duren, Scott Hensley, Michael Kobrick, et al. 2007. “The Shuttle Radar Topography Mission.” <em>Reviews of Geophysics</em> 45 (2). <a href="https://doi.org/10.1029/2005RG000183">https://doi.org/10.1029/2005RG000183</a>.</p>
</div>
<div>
<p>Gorelick, Noel, Matt Hancher, Mike Dixon, Simon Ilyushchenko, David Thau, and Rebecca Moore. 2017. “Google Earth Engine: Planetary-Scale Geospatial Analysis for Everyone.” <em>Remote Sensing of Environment</em> 202: 18–27. <a href="https://doi.org/10.1016/j.rse.2017.06.031">https://doi.org/10.1016/j.rse.2017.06.031</a>.</p>
</div>
<div>
<p>Schmidt, Gail, Calli B. Jenkerson, Jeffrey Masek, Eric Vermote, and Feng Gao. 2013. “Landsat Ecosystem Disturbance Adaptive Processing System (LEDAPS) Algorithm Description.” USGS Numbered Series 2013-1057. Open-File Report. Reston, VA: U.S. Geological Survey. <a href="http://pubs.er.usgs.gov/publication/ofr20131057">http://pubs.er.usgs.gov/publication/ofr20131057</a>.</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-farr2007">
<p>Farr, Tom G., Paul A. Rosen, Edward Caro, Robert Crippen, Riley Duren, Scott Hensley, Michael Kobrick, et al. 2007. “The Shuttle Radar Topography Mission.” <em>Reviews of Geophysics</em> 45 (2). <a href="https://doi.org/10.1029/2005RG000183">https://doi.org/10.1029/2005RG000183</a>.</p>
</div>
<div id="ref-gorelick2017">
<p>Gorelick, Noel, Matt Hancher, Mike Dixon, Simon Ilyushchenko, David Thau, and Rebecca Moore. 2017. “Google Earth Engine: Planetary-Scale Geospatial Analysis for Everyone.” <em>Remote Sensing of Environment</em> 202: 18–27. <a href="https://doi.org/10.1016/j.rse.2017.06.031">https://doi.org/10.1016/j.rse.2017.06.031</a>.</p>
</div>
<div id="ref-schmidt2013">
<p>Schmidt, Gail, Calli B. Jenkerson, Jeffrey Masek, Eric Vermote, and Feng Gao. 2013. “Landsat Ecosystem Disturbance Adaptive Processing System (LEDAPS) Algorithm Description.” USGS Numbered Series 2013-1057. Open-File Report. Reston, VA: U.S. Geological Survey. <a href="http://pubs.er.usgs.gov/publication/ofr20131057">http://pubs.er.usgs.gov/publication/ofr20131057</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="preliminary-data-preparation.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pratikunterwegs/elephantTempKruger/edit/master/08_getting_spatial_data.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
